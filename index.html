<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image to PDF Converter</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useCallback } = React;
        
        // Lucide React icons as inline SVG components
        const Upload = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
            </svg>
        );
        
        const FileImage = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
        );
        
        const X = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
            </svg>
        );
        
        const Download = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
            </svg>
        );
        
        const Loader2 = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83" />
            </svg>
        );

        // Main App Component (paste the React component code here)
        const ImageToPdfConverter = () => {
          const [images, setImages] = useState([]);
          const [isDragging, setIsDragging] = useState(false);
          const [isProcessing, setIsProcessing] = useState(false);

          const handleDragEnter = useCallback((e) => {
            e.preventDefault();
            e.stopPropagation();
            setIsDragging(true);
          }, []);

          const handleDragLeave = useCallback((e) => {
            e.preventDefault();
            e.stopPropagation();
            setIsDragging(false);
          }, []);

          const handleDragOver = useCallback((e) => {
            e.preventDefault();
            e.stopPropagation();
          }, []);

          const handleDrop = useCallback((e) => {
            e.preventDefault();
            e.stopPropagation();
            setIsDragging(false);

            const files = Array.from(e.dataTransfer.files).filter(file =>
              file.type.startsWith('image/')
            );

            addImages(files);
          }, []);

          const handleFileInput = (e) => {
            const files = Array.from(e.target.files);
            addImages(files);
          };

          const addImages = (files) => {
            const newImages = files.map(file => ({
              id: Math.random().toString(36).substr(2, 9),
              file,
              preview: URL.createObjectURL(file),
              name: file.name
            }));

            setImages(prev => [...prev, ...newImages]);
          };

          const removeImage = (id) => {
            setImages(prev => {
              const image = prev.find(img => img.id === id);
              if (image) URL.revokeObjectURL(image.preview);
              return prev.filter(img => img.id !== id);
            });
          };

          const moveImage = (id, direction) => {
            setImages(prev => {
              const index = prev.findIndex(img => img.id === id);
              if (index === -1) return prev;
              
              const newIndex = direction === 'up' ? index - 1 : index + 1;
              if (newIndex < 0 || newIndex >= prev.length) return prev;
              
              const newImages = [...prev];
              [newImages[index], newImages[newIndex]] = [newImages[newIndex], newImages[index]];
              return newImages;
            });
          };

          const generatePDF = async () => {
            if (images.length === 0) return;

            setIsProcessing(true);

            try {
              const { jsPDF } = window.jspdf;

              const pdf = new jsPDF({
                orientation: 'portrait',
                unit: 'mm',
                format: 'a4'
              });

              const pageWidth = 210;
              const pageHeight = 297;
              const margin = 10;
              const spacing = 5;
              const imgWidth = (pageWidth - 2 * margin - spacing) / 2;
              const imgHeight = (pageHeight - 2 * margin - spacing) / 2;

              const positions = [
                [margin, margin],
                [margin + imgWidth + spacing, margin],
                [margin, margin + imgHeight + spacing],
                [margin + imgWidth + spacing, margin + imgHeight + spacing]
              ];

              for (let i = 0; i < images.length; i++) {
                const posIndex = i % 4;
                
                if (posIndex === 0 && i > 0) {
                  pdf.addPage();
                }

                const img = images[i];
                const imgElement = new Image();
                
                await new Promise((resolve, reject) => {
                  imgElement.onload = resolve;
                  imgElement.onerror = reject;
                  imgElement.src = img.preview;
                });

                const imgRatio = imgElement.width / imgElement.height;
                const boxRatio = imgWidth / imgHeight;

                let finalWidth, finalHeight;
                if (imgRatio > boxRatio) {
                  finalWidth = imgWidth;
                  finalHeight = imgWidth / imgRatio;
                } else {
                  finalHeight = imgHeight;
                  finalWidth = imgHeight * imgRatio;
                }

                const xOffset = (imgWidth - finalWidth) / 2;
                const yOffset = (imgHeight - finalHeight) / 2;

                pdf.addImage(
                  imgElement,
                  'JPEG',
                  positions[posIndex][0] + xOffset,
                  positions[posIndex][1] + yOffset,
                  finalWidth,
                  finalHeight
                );
              }

              pdf.save('images-collection.pdf');
            } catch (error) {
              console.error('Error generating PDF:', error);
              alert('Error generating PDF. Please try again.');
            } finally {
              setIsProcessing(false);
            }
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8">
              <div className="max-w-6xl mx-auto">
                <div className="text-center mb-8">
                  <h1 className="text-4xl font-bold text-gray-800 mb-2">
                    Image to PDF Converter
                  </h1>
                  <p className="text-gray-600">
                    Upload images and create a PDF with 4 images per page
                  </p>
                </div>

                <div
                  onDragEnter={handleDragEnter}
                  onDragOver={handleDragOver}
                  onDragLeave={handleDragLeave}
                  onDrop={handleDrop}
                  className={`border-4 border-dashed rounded-2xl p-12 mb-8 transition-all ${
                    isDragging
                      ? 'border-blue-500 bg-blue-50'
                      : 'border-gray-300 bg-white'
                  }`}
                >
                  <div className="text-center">
                    <Upload className="mx-auto h-16 w-16 text-gray-400 mb-4" />
                    <p className="text-xl font-semibold text-gray-700 mb-2">
                      Drop images here or click to upload
                    </p>
                    <p className="text-gray-500 mb-4">
                      Supports JPG, PNG, GIF, and more
                    </p>
                    <label className="inline-block">
                      <input
                        type="file"
                        multiple
                        accept="image/*"
                        onChange={handleFileInput}
                        className="hidden"
                      />
                      <span className="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg cursor-pointer inline-block transition-colors">
                        Select Images
                      </span>
                    </label>
                  </div>
                </div>

                {images.length > 0 && (
                  <div className="bg-white rounded-2xl shadow-lg p-6 mb-8">
                    <div className="flex justify-between items-center mb-4">
                      <h2 className="text-2xl font-bold text-gray-800">
                        {images.length} Image{images.length !== 1 ? 's' : ''} Selected
                      </h2>
                      <button
                        onClick={generatePDF}
                        disabled={isProcessing}
                        className="bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white px-6 py-3 rounded-lg font-semibold flex items-center gap-2 transition-colors"
                      >
                        {isProcessing ? (
                          <>
                            <Loader2 className="h-5 w-5 animate-spin" />
                            Generating...
                          </>
                        ) : (
                          <>
                            <Download className="h-5 w-5" />
                            Generate PDF
                          </>
                        )}
                      </button>
                    </div>

                    <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                      {images.map((img, index) => (
                        <div
                          key={img.id}
                          className="relative group bg-gray-50 rounded-lg overflow-hidden border-2 border-gray-200 hover:border-blue-400 transition-all"
                        >
                          <img
                            src={img.preview}
                            alt={img.name}
                            className="w-full h-48 object-cover"
                          />
                          <div className="absolute top-2 left-2 bg-blue-500 text-white px-2 py-1 rounded text-sm font-semibold">
                            #{index + 1}
                          </div>
                          <button
                            onClick={() => removeImage(img.id)}
                            className="absolute top-2 right-2 bg-red-500 hover:bg-red-600 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity"
                          >
                            <X className="h-5 w-5" />
                          </button>
                          <div className="p-2 bg-white">
                            <p className="text-sm text-gray-600 truncate">{img.name}</p>
                            <div className="flex gap-2 mt-2">
                              <button
                                onClick={() => moveImage(img.id, 'up')}
                                disabled={index === 0}
                                className="text-xs bg-gray-200 hover:bg-gray-300 disabled:opacity-50 px-2 py-1 rounded"
                              >
                                ↑
                              </button>
                              <button
                                onClick={() => moveImage(img.id, 'down')}
                                disabled={index === images.length - 1}
                                className="text-xs bg-gray-200 hover:bg-gray-300 disabled:opacity-50 px-2 py-1 rounded"
                              >
                                ↓
                              </button>
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                )}

                {images.length === 0 && (
                  <div className="bg-white rounded-2xl shadow-lg p-8 text-center">
                    <FileImage className="mx-auto h-24 w-24 text-gray-300 mb-4" />
                    <h3 className="text-xl font-semibold text-gray-700 mb-2">
                      No images uploaded yet
                    </h3>
                    <p className="text-gray-500">
                      Upload your images to get started
                    </p>
                  </div>
                )}
              </div>
            </div>
          );
        };

        // Render the app
        ReactDOM.render(<ImageToPdfConverter />, document.getElementById('root'));
    </script>
</body>
</html>
